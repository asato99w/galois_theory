# Phase 2: 多項式環の実装

## 概要と目的

このフェーズでは、ガロア理論の中核となる多項式とその環構造を実装します。多項式は5次方程式の可解性判定において主役となる数学的対象であり、その性質（既約性、因数分解、最大公約式など）を理解することが、後のガロア群の計算に直結します。

## 理論的背景

### 多項式環とは何か

多項式環K[x]は、体Kを係数とする一変数多項式全体の集合です。例えば、有理数体Q上の多項式環Q[x]には、以下のような多項式が含まれます：

- 2x³ + 3x² - 5x + 1
- x⁵ - 2
- 7x - 3

多項式環は環の構造を持ち、多項式同士の加法と乗法が定義されます。重要な点は、多項式環は体ではないということです。例えば、多項式xの乗法逆元は存在しません。

### 既約多項式の重要性

多項式が既約（irreducible）であるとは、それより低次の多項式の積として表現できないことを意味します。既約多項式は、素数が整数論で果たす役割と同様に、多項式論において基本的な構成要素となります。

5次方程式の可解性判定において、既約性は決定的に重要です：
- 既約でない5次多項式は、より低次の多項式の積として分解でき、個別に解くことができます
- 既約な5次多項式こそが、ガロア理論の真の対象となります

### 最大公約式と互除法

二つの多項式の最大公約式（GCD）は、両方を割り切る最高次の多項式です。ユークリッドの互除法を多項式に適用することで、効率的に計算できます。

最大公約式は以下の場面で重要です：
- 多項式の既約性判定
- 分離可能性の判定（多項式とその導関数のGCDが定数かどうか）
- 体の拡大における最小多項式の計算

## 実装の戦略

### なぜ一般的な多項式環から始めるのか

5次多項式に特化した実装から始めることも可能ですが、一般的な多項式環から実装を始める理由は以下の通りです：

1. **理論的完全性**: ガロア理論は任意の次数の多項式に適用される一般理論です
2. **再利用性**: 他の次数の多項式や、複数の変数を持つ多項式への拡張が容易です
3. **アルゴリズムの理解**: 一般的なアルゴリズムを実装することで、その本質を理解できます

### 実装上の課題と解決策

#### 課題1: 係数の正規化
多項式の最高次係数が0になる場合の処理が必要です。

**解決策**: 多項式の作成時と演算後に自動的に正規化を行います。

#### 課題2: 次数の定義
零多項式の次数をどう定義するかという問題があります。

**解決策**: 零多項式の次数を-∞または特別な値として扱います。

#### 課題3: 既約性判定の効率性
既約性判定は計算量が多く、効率的なアルゴリズムが必要です。

**解決策**: アイゼンシュタインの既約判定法や、有限体上での効率的なアルゴリズムを実装します。

## 具体的な実装手順

### Week 1: 基本的な多項式演算の実装

#### 1.1 Polynomialクラスの設計
多項式は係数のリストとして表現します：
- `coeffs`: 係数のリスト（定数項から最高次項の順）
- `field`: 係数体
- `degree()`: 多項式の次数を返すメソッド

#### 1.2 基本演算の実装
**加法**: 係数ごとの加法
```
(a₀ + a₁x + a₂x²) + (b₀ + b₁x + b₂x²) = (a₀+b₀) + (a₁+b₁)x + (a₂+b₂)x²
```

**乗法**: 係数の畳み込み
```
(a₀ + a₁x) × (b₀ + b₁x) = a₀b₀ + (a₀b₁ + a₁b₀)x + a₁b₁x²
```

#### 1.3 多項式の評価
ホーナー法を使用した効率的な多項式の値の計算：
```
f(x) = a₀ + a₁x + a₂x² + a₃x³ = a₀ + x(a₁ + x(a₂ + xa₃))
```

#### 1.4 導関数の計算
多項式の導関数は、各項の次数を係数に掛けることで計算できます：
```
(a₀ + a₁x + a₂x² + a₃x³)' = a₁ + 2a₂x + 3a₃x²
```

### Week 2: 既約性判定アルゴリズムの実装

#### 2.1 アイゼンシュタインの既約判定法
多項式 f(x) = aₙxⁿ + aₙ₋₁xⁿ⁻¹ + ... + a₁x + a₀ について、素数pが存在して：
1. p は aₙ を割らない
2. p は a₀, a₁, ..., aₙ₋₁ を全て割る
3. p² は a₀ を割らない

この条件を満たす場合、f(x)は既約です。

#### 2.2 有限体上での既約性テスト
Rabinの既約性テストを実装：
1. 多項式を有限体上で考える
2. x^(p^i) - x との最大公約式を計算
3. 全ての i について GCD が 1 なら既約

#### 2.3 因数分解アルゴリズム
Berlekamp-Zassenhaus アルゴリズムまたは Cantor-Zassenhaus アルゴリズムを実装して、多項式の完全な因数分解を行います。

#### 2.4 特殊ケースの最適化
- 一次多項式は常に既約
- 二次多項式は判別式で既約性を判定
- 三次多項式は有理根定理を適用

### Week 3: 多項式の因数分解アルゴリズム

#### 3.1 有理根定理の実装
有理数体上の多項式について、有理根は以下の形になります：
```
有理根 = ±(a₀の約数)/(aₙの約数)
```

#### 3.2 平方自由分解
多項式を平方自由な因子に分解するアルゴリズム：
1. f(x) と f'(x) の最大公約式 g(x) を計算
2. f(x) / g(x) を計算（これが平方自由部分）
3. 再帰的に処理

#### 3.3 Henselの補題
有限体上での因数分解を、より大きな体（または環）に持ち上げる手法を実装します。

#### 3.4 因数分解の検証
分解結果が正しいかどうかを検証するメソッドを実装：
- 因子の積が元の多項式と等しいか
- 各因子が既約かどうか

## 理論的な深掘り

### 多項式環の構造

多項式環K[x]は主イデアル整域（PID）です。これは以下を意味します：

1. **整域**: 零因子が存在しない（ab = 0 ⟹ a = 0 または b = 0）
2. **主イデアル整域**: 全てのイデアルが単一の元で生成される
3. **一意因数分解**: 任意の多項式は既約多項式の積として一意に分解される

### ガロア理論との関連

多項式環の性質は、ガロア理論において以下の役割を果たします：

1. **最小多項式**: 代数的元の最小多項式は既約多項式
2. **分解体**: 多項式が完全に分解する最小の体
3. **ガロア群**: 多項式の根の置換群として定義される

### 具体例による理解

#### 例1: 既約多項式
- f(x) = x² + 1 は有理数体Q上で既約（有理根を持たない）
- f(x) = x² + 1 は複素数体C上で既約でない（= (x+i)(x-i)）

#### 例2: 5次多項式の例
- f(x) = x⁵ - 2 は既約（アイゼンシュタインの判定法でp=2）
- f(x) = x⁵ - 1 は既約でない（= (x-1)(x⁴+x³+x²+x+1)）

#### 例3: 最大公約式
- f(x) = x³ - 1, g(x) = x² - 1 の場合
- GCD(f,g) = x - 1

## 実装上の注意点

### 数値精度の管理

多項式の係数が有理数の場合、分数の演算で分母が大きくなる可能性があります：

1. **分数の約分**: 演算後に常に約分を行う
2. **共通分母の管理**: 効率的な分数演算のアルゴリズム
3. **オーバーフローの防止**: 大きな数値の処理

### アルゴリズムの効率性

多項式の演算は次数に対して多項式時間で実行される必要があります：

1. **FFT**: 高次多項式の乗法にはFFTを使用
2. **分割統治法**: 大きな問題を小さな問題に分割
3. **キャッシュ**: 頻繁に使用される計算結果をキャッシュ

### エラーハンドリング

多項式演算では様々なエラーが発生する可能性があります：

1. **零除算**: 多項式による除算で余りが出る場合
2. **次数の不整合**: 期待した次数と異なる場合
3. **係数体の不一致**: 異なる体上の多項式同士の演算

## 次のフェーズへの準備

Phase 2で実装した多項式環は、Phase 3の体の拡大理論で直接使用されます：

1. **最小多項式**: 体の拡大における生成元の最小多項式
2. **既約性**: 体の拡大の次数を決定する重要な性質
3. **分解**: 分解体の構成において、多項式の因数分解が必要

## 学習のポイント

### アルゴリズムの理解

このフェーズでは、古典的な数学アルゴリズムを実装することで、その動作原理を深く理解できます：

1. **ユークリッドの互除法**: 最大公約式の計算
2. **ホーナー法**: 効率的な多項式の評価
3. **因数分解アルゴリズム**: 複雑な数学的構造の分解

### 計算複雑性の意識

多項式演算の計算量を常に意識することで、効率的なプログラムを作成できます：

1. **時間計算量**: 各演算の実行時間
2. **空間計算量**: メモリ使用量
3. **実用的な最適化**: 理論的最適性と実用性のバランス

## 成果物の活用

Phase 2で作成される成果物は、以下のように活用されます：

1. **`polynomial.py`**: 多項式の基本クラス
2. **`irreducibility.py`**: 既約性判定の専門モジュール
3. **`test_polynomials.py`**: 多項式演算の品質保証

このフェーズを完了することで、ガロア理論の実装に必要な多項式の操作が可能になり、次のフェーズの体の拡大理論に進む準備が整います。特に、既約多項式の判定能力は、体の拡大における最小多項式の計算に直接活用されます。 